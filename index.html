<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SP-7 - Glass ERP (SAP HANA Style)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { min-height: 100vh; background: linear-gradient(135deg, #e5f0f9, #f0f7ff, #e0efff); font-family: system-ui, sans-serif; color: #1e293b; display: flex; }
    .sidebar { width: 280px; background: rgba(255,255,255,0.94); backdrop-filter: blur(14px); border-right: 1px solid #e2e8f0; height: 100vh; position: fixed; overflow-y: auto; box-shadow: 2px 0 12px rgba(0,0,0,0.05); }
    .sidebar-header { padding: 18px 24px; font-size: 1.45rem; font-weight: 700; color: #0f766e; border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; gap: 12px; }
    .menu-section { margin: 16px 0; }
    .menu-header { padding: 12px 24px; font-size: 0.95rem; font-weight: 600; color: #475569; text-transform: uppercase; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
    .menu-header:hover { background: rgba(15,118,110,0.06); }
    .menu-header i.toggle { transition: transform 0.3s; }
    .menu-header.collapsed i.toggle { transform: rotate(-90deg); }
    .menu-items { overflow: hidden; transition: max-height 0.4s ease; }
    .menu-item { padding: 12px 24px 12px 52px; cursor: pointer; transition: all 0.2s; position: relative; }
    .menu-item::before { content: ''; position: absolute; left: 28px; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #0f766e; border-radius: 50%; opacity: 0; }
    .menu-item:hover, .menu-item.active { background: rgba(15,118,110,0.08); color: #0f766e; }
    .menu-item:hover::before, .menu-item.active::before { opacity: 1; }
    .main { margin-left: 280px; flex: 1; padding: 80px 32px 32px; }
    .shell-bar { position: fixed; top: 0; left: 280px; right: 0; height: 56px; background: rgba(255,255,255,0.96); backdrop-filter: blur(16px); border-bottom: 1px solid #e2e8f0; display: flex; align-items: center; padding: 0 32px; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
    .shell-bar .logo { font-weight: 700; font-size: 1.25rem; color: #0f766e; }
    .shell-bar .right { margin-left: auto; display: flex; gap: 24px; align-items: center; }
    .shell-bar i { font-size: 1.3rem; color: #475569; cursor: pointer; }
    .shell-bar i:hover { color: #0f766e; }
    .avatar { width: 36px; height: 36px; border-radius: 50%; background: #0f766e; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .module-page { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 4px 16px rgba(0,0,0,0.06); border: 1px solid #e2e8f0; }
    .module-page h1 { color: #0f766e; font-size: 1.6rem; margin-bottom: 16px; }
    table { width: 100%; border-collapse: collapse; margin: 16px 0; }
    th, td { padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0; }
    th { background: #f1f5f9; font-weight: 600; }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; margin-bottom: 6px; font-weight: 500; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; }
    .btn { padding: 10px 20px; background: #0f766e; color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 8px; }
    .btn:hover { background: #0d5f59; }
    .btn-secondary { background: #64748b; }
    .btn-danger { background: #ef4444; }
    .search-input { padding: 10px; width: 300px; margin-bottom: 16px; border: 1px solid #cbd5e1; border-radius: 6px; }
    .form { margin:20px 0; padding:16px; border:1px solid #e2e8f0; border-radius:8px; display: none; }
  </style>
</head>
<body>

  <!-- Sidebar (full list) -->
  <div class="sidebar">
    <div class="sidebar-header"><i class="fas fa-glass-cheers"></i> SP-7</div>
    <!-- All sections as before, no change -->
    <div class="menu-section">
      <div class="menu-header" data-target="masters"><span>Master’s</span><i class="fas fa-chevron-down toggle"></i></div>
      <div class="menu-items" id="masters">
        <div class="menu-item active" data-module="item-master">Item Master</div>
        <div class="menu-item" data-module="price-master">Price Master</div>
        <div class="menu-item" data-module="process-master">Process Master</div>
        <div class="menu-item" data-module="z-rule">Z Rule</div>
        <div class="menu-item" data-module="jumbo-size">Jumbo Size</div>
        <div class="menu-item" data-module="glass-type">Glass Type</div>
        <div class="menu-item" data-module="route-master">Route Master</div>
        <div class="menu-item" data-module="payment-terms">Payment Terms</div>
        <div class="menu-item" data-module="film-type">Film Type</div>
        <div class="menu-item" data-module="bank-details">Bank Details</div>
        <div class="menu-item" data-module="vehicle-master">Vehicle Master</div>
        <div class="menu-item" data-module="other-charges">Other Charges</div>
        <div class="menu-item" data-module="remarks">Remarks</div>
      </div>
    </div>
    <!-- Remaining sections identical to previous code -->
  </div>

  <!-- Top Bar -->
  <div class="shell-bar">
    <div class="logo">SP-7 Dashboard</div>
    <div class="right">
      <i class="fas fa-bell"></i>
      <i class="fas fa-cog"></i>
      <div class="avatar">R</div>
    </div>
  </div>

  <!-- Main -->
  <div class="main">
    <div id="content-area"></div>
  </div>

  <script>
    // Data
    let items = [{ id: 1, code: 'GLS-001', desc: 'Clear Float Glass 8mm', type: 'Glass', unit: 'Sqft', price: 95 }];
    let customers = [{ id: 1, name: 'ABC Interiors', mobile: '9876543210', address: 'Delhi' }];
    let glassStock = [{ id: 1, item: 'Clear Float Glass 8mm', thickness: '8mm', available: 12000, location: 'Godown A' }];
    let invoices = [];
    let breakage = []; // For reports

    // Render Module
    function renderModule(mod) {
      const area = document.getElementById('content-area');
      let html = `<div class="module-page"><h1>${mod.replace(/-/g, ' ').toUpperCase()}</h1>`;

      if (mod === 'item-master') {
        html += `<input type="text" id="search-item" class="search-input" placeholder="Search..." oninput="filterTable('item')">
          <button class="btn" onclick="showForm('item-form')">+ Add Item</button>
          <div id="item-form" class="form">
            <div class="form-group"><label>Code</label><input id="item-code"></div>
            <div class="form-group"><label>Desc</label><input id="item-desc"></div>
            <div class="form-group"><label>Type</label><select id="item-type"><option>Glass</option><option>Hardware</option></select></div>
            <div class="form-group"><label>Unit</label><input id="item-unit" value="Sqft"></div>
            <div class="form-group"><label>Price</label><input id="item-price" type="number"></div>
            <input type="hidden" id="item-id">
            <button class="btn" onclick="saveItem()">Save</button> <button class="btn-secondary" onclick="hideForm('item-form')">Cancel</button>
          </div>
          <table id="item-table"><thead><tr><th>Code</th><th>Desc</th><th>Type</th><th>Unit</th><th>Price</th><th>Actions</th></tr></thead><tbody id="item-body"></tbody></table>`;
      } else if (mod === 'glass-stock') {
        html += `<input type="text" id="search-stock" class="search-input" placeholder="Search..." oninput="filterTable('stock')">
          <button class="btn" onclick="showForm('stock-form')">+ Add Stock</button>
          <div id="stock-form" class="form">
            <div class="form-group"><label>Item</label><select id="stock-item">\( {items.map(i => `<option value=" \){i.desc}">${i.desc}</option>`).join('')}</select></div>
            <div class="form-group"><label>Thickness</label><input id="stock-thickness"></div>
            <div class="form-group"><label>Available</label><input id="stock-available" type="number"></div>
            <div class="form-group"><label>Location</label><input id="stock-location"></div>
            <input type="hidden" id="stock-id">
            <button class="btn" onclick="saveStock()">Save</button> <button class="btn-secondary" onclick="hideForm('stock-form')">Cancel</button>
          </div>
          <table id="stock-table"><thead><tr><th>Item</th><th>Thickness</th><th>Available</th><th>Location</th><th>Actions</th></tr></thead><tbody id="stock-body"></tbody></table>`;
      } else if (mod === 'invoice') {
        html += `<div class="form-group"><label>Customer</label><select id="inv-customer">\( {customers.map(c => `<option value=" \){c.id}">${c.name}</option>`).join('')}</select></div>
          <div class="form-group"><label>Date</label><input id="inv-date" type="date" value="${new Date().toISOString().split('T')[0]}"></div>
          <table id="inv-lines"><thead><tr><th>Item</th><th>Qty</th><th>Rate</th><th>Amount</th><th></th></tr></thead><tbody id="inv-body"></tbody></table>
          <button class="btn" onclick="addInvLine()">+ Add Line</button>
          <p>Total: ₹<span id="inv-total">0</span></p>
          <button class="btn" onclick="saveInvoice()">Save Invoice</button>`;
      } else if (mod === 'new-customer') {
        html += `<div class="form">
          <div class="form-group"><label>Name</label><input id="cust-name"></div>
          <div class="form-group"><label>Mobile</label><input id="cust-mobile" type="tel"></div>
          <div class="form-group"><label>Address</label><textarea id="cust-address"></textarea></div>
          <button class="btn" onclick="saveCustomer()">Save</button>
        </div>`;
      } else if (mod === 'billed-sqmt') {
        const totalSqmt = invoices.reduce((sum, inv) => sum + inv.lines.reduce((s, l) => s + l.qty, 0), 0);
        html += `<p>Total Billed Sqmt: <strong>${totalSqmt}</strong></p>`;
      } else {
        html += `<p>Module working: Add your configs/data here.</p>`;
      }

      html += `</div>`;
      area.innerHTML = html;

      if (mod === 'item-master') renderTable('item');
      if (mod === 'glass-stock') renderTable('stock');
      if (mod === 'invoice') renderInvLines();
    }

    // Functions
    function showForm(id) { document.getElementById(id).style.display = 'block'; }
    function hideForm(id) { document.getElementById(id).style.display = 'none'; clearForm(id); }
    function clearForm(id) { document.querySelectorAll(`#\( {id} input, # \){id} select`).forEach(el => el.value = ''); }

    function renderTable(type, filter = '') {
      let data = type === 'item' ? items : glassStock;
      const body = document.getElementById(`${type}-body`);
      body.innerHTML = data.filter(d => Object.values(d).some(v => v.toString().toLowerCase().includes(filter.toLowerCase()))).map(d => {
        return `<tr><td>\( {d.item || d.code}</td><td> \){d.desc || d.thickness}</td><td>\( {d.type || d.available}</td><td> \){d.unit || d.location}</td><td>${d.price || ''}</td>
          <td><button class="btn-secondary" onclick="edit\( {type.charAt(0).toUpperCase() + type.slice(1)}( \){d.id})">Edit</button> <button class="btn-danger" onclick="deleteEntry('${type}', ${d.id})">Delete</button></td></tr>`;
      }).join('');
    }

    function filterTable(type) {
      const val = document.getElementById(`search-${type}`).value;
      renderTable(type, val);
    }

    function saveItem() {
      const id = parseInt(document.getElementById('item-id').value) || items.length + 1;
      const code = document.getElementById('item-code').value;
      const desc = document.getElementById('item-desc').value;
      const type = document.getElementById('item-type').value;
      const unit = document.getElementById('item-unit').value;
      const price = parseFloat(document.getElementById('item-price').value);
      if (!code || !desc) return alert('Fill required fields!');
      const index = items.findIndex(i => i.id === id);
      if (index > -1) items[index] = { id, code, desc, type, unit, price };
      else items.push({ id, code, desc, type, unit, price });
      renderTable('item');
      hideForm('item-form');
    }

    function editItem(id) {
      const i = items.find(i => i.id === id);
      document.getElementById('item-id').value = i.id;
      document.getElementById('item-code').value = i.code;
      document.getElementById('item-desc').value = i.desc;
      document.getElementById('item-type').value = i.type;
      document.getElementById('item-unit').value = i.unit;
      document.getElementById('item-price').value = i.price;
      showForm('item-form');
    }

    function saveStock() {
      const id = parseInt(document.getElementById('stock-id').value) || glassStock.length + 1;
      const item = document.getElementById('stock-item').value;
      const thickness = document.getElementById('stock-thickness').value;
      const available = parseFloat(document.getElementById('stock-available').value);
      const location = document.getElementById('stock-location').value;
      if (!item || !available) return alert('Fill required fields!');
      const index = glassStock.findIndex(s => s.id === id);
      if (index > -1) glassStock[index] = { id, item, thickness, available, location };
      else glassStock.push({ id, item, thickness, available, location });
      renderTable('stock');
      hideForm('stock-form');
    }

    function editStock(id) {
      const s = glassStock.find(s => s.id === id);
      document.getElementById('stock-id').value = s.id;
      document.getElementById('stock-item').value = s.item;
      document.getElementById('stock-thickness').value = s.thickness;
      document.getElementById('stock-available').value = s.available;
      document.getElementById('stock-location').value = s.location;
      showForm('stock-form');
    }

    function deleteEntry(type, id) {
      if (!confirm('Delete?')) return;
      if (type === 'item') items = items.filter(i => i.id !== id);
      if (type === 'stock') glassStock = glassStock.filter(s => s.id !== id);
      renderTable(type);
    }

    function saveCustomer() {
      const name = document.getElementById('cust-name').value;
      const mobile = document.getElementById('cust-mobile').value;
      const address = document.getElementById('cust-address').value;
      if (!name) return alert('Name required!');
      customers.push({ id: customers.length + 1, name, mobile, address });
      alert('Saved!');
      clearForm('new-customer form'); // Adjust if needed
    }

    let invLines = [];
    function addInvLine() {
      const itemSelect = document.createElement('select');
      itemSelect.innerHTML = items.map(i => `<option value="\( {i.id}" data-price=" \){i.price}">${i.desc}</option>`).join('');
      const qtyInput = document.createElement('input');
      qtyInput.type = 'number'; qtyInput.value = 1;
      const row = document.createElement('tr');
      row.innerHTML = `<td>\( {itemSelect.outerHTML}</td><td> \){qtyInput.outerHTML}</td><td></td><td></td><td><button class="btn-danger" onclick="this.parentNode.parentNode.remove(); updateInvTotal();">Remove</button></td>`;
      document.getElementById('inv-body').appendChild(row);
      updateInvTotal();
    }

    function updateInvTotal() {
      let total = 0;
      document.querySelectorAll('#inv-body tr').forEach(row => {
        const itemId = row.querySelector('select').value;
        const qty = parseFloat(row.querySelector('input').value) || 0;
        const item = items.find(i => i.id == itemId);
        if (item) {
          const amount = qty * item.price;
          row.querySelectorAll('td')[2].textContent = item.price;
          row.querySelectorAll('td')[3].textContent = amount;
          total += amount;
        }
      });
      document.getElementById('inv-total').textContent = total;
    }

    function saveInvoice() {
      const customer = document.getElementById('inv-customer').value;
      const date = document.getElementById('inv-date').value;
      const lines = Array.from(document.querySelectorAll('#inv-body tr')).map(row => {
        const itemId = row.querySelector('select').value;
        const qty = parseFloat(row.querySelector('input').value);
        return { itemId, qty };
      });
      invoices.push({ id: invoices.length + 1, customer, date, lines });
      lines.forEach(l => {
        const stockItem = glassStock.find(s => s.item === items.find(i => i.id == l.itemId).desc);
        if (stockItem) stockItem.available -= l.qty;
      });
      alert('Invoice saved! Stock updated.');
      renderModule('invoice');
    }

    // Collapsible and menu click same as before
    document.querySelectorAll('.menu-header').forEach(h => {
      h.addEventListener('click', () => {
        const target = document.getElementById(h.dataset.target);
        h.classList.toggle('collapsed');
        target.style.maxHeight = h.classList.contains('collapsed') ? '0' : target.scrollHeight + 'px';
      });
      if (h.dataset.target === 'masters') h.click();
    });

    document.querySelectorAll('.menu-item').forEach(item => {
      item.addEventListener('click', () => {
        document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
        item.classList.add('active');
        renderModule(item.dataset.module);
      });
    });

    renderModule('item-master');
  </script>
</body>
</html>
